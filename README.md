# 투표 시스템

Flask 기반의 간단한 투표 시스템입니다. QR 코드를 통한 토큰 기반 투표와 관리자 대시보드를 제공합니다.

## 주요 기능

- QR 코드 기반 투표 토큰 생성
- 토큰별 단일 투표 제한
- 실시간 투표 현황 모니터링
- 관리자 대시보드
- 투표 시작/종료 제어
- 로컬 네트워크 자동 감지 및 보안
- IP 기반 접근 제한
- GUI 기반 서버 런처 프로그램
- 투표 로그 자동 기록 및 백업
- 비전문가용 단일 실행 파일 제공

## 설치 및 실행

### 1. 필요한 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. 환경변수 설정

`.env` 파일을 생성하고 다음 내용을 추가합니다:
```
ADMIN_PASSWORD=your_secure_password
```

### 3. 실행 방법

#### 방법 1: GUI 런처 사용 (권장)
1. `launcher.py` 실행:
```bash
python launcher.py
```

2. 또는 빌드된 실행 파일 사용:
```bash
# 실행 파일 빌드
python build.py
# dist 폴더의 vote_system.exe 실행
```

#### 방법 2: 직접 실행
```bash
python app.py
```

## GUI 런처 사용법

1. **서버 제어**
   - "서버 시작" 버튼으로 Flask 서버 실행
   - "서버 종료" 버튼으로 서버 중지
   - 서버 상태가 실시간으로 표시됨

2. **토큰 관리**
   - 토큰 수 입력 후 "QR 코드 생성" 버튼 클릭
   - 생성된 QR 코드 ZIP 파일 저장 위치 선택
   - 서버 로그에서 생성 과정 확인 가능

3. **로그 관리**
   - 투표 로그는 자동으로 `log/` 디렉토리에 CSV 파일로 저장됨
   - "로그 내보내기" 버튼으로 모든 로그를 ZIP 파일로 다운로드
   - 로그는 날짜별로 구분되어 저장됨

4. **관리자 페이지**
   - "관리자 페이지 열기" 버튼으로 웹 브라우저에서 관리자 대시보드 접속
   - 로그인 후 투표 관리 가능

5. **로그 확인**
   - 서버 로그 창에서 실시간으로 서버 상태와 오류 확인 가능

## 비전문가용 번들

시스템은 단일 실행 파일로도 제공됩니다:

1. **특징**
   - 설치 없이 바로 실행 가능
   - 데이터베이스 자동 생성
   - 로그 디렉토리 자동 생성
   - 기본 환경 설정 포함

2. **사용법**
   - `vote_system.exe` 더블클릭으로 실행
   - 서버 시작 후 QR 코드 생성
   - 관리자 페이지에서 투표 관리

3. **주의사항**
   - 실행 파일은 `data.db`와 `log` 폴더를 포함
   - 실행 시 필요한 파일들이 자동으로 생성됨
   - 로그 파일은 실행 파일과 같은 디렉토리에 저장됨

## 사용 방법

### 관리자 페이지
- URL: `/admin`
- 기본 관리자 비밀번호: `.env` 파일에 설정된 값
- 기능:
  - 투표 항목 생성
  - 투표 토큰 생성
  - 투표 시작/종료
  - 투표 결과 확인

### 투표 참여
1. QR 코드 스캔 또는 토큰 입력
2. 투표 항목 선택
3. 투표 제출

## 보안 기능

- 관리자 페이지는 비밀번호로 보호됩니다
- 토큰은 한 번만 사용 가능합니다
- 투표는 활성화된 상태에서만 참여 가능합니다
- 로컬 네트워크 자동 감지 및 IP 기반 접근 제한
- QR 코드에 로컬 IP 포함으로 외부 접근 방지

## 데이터베이스 스키마

### tokens 테이블
- id: 토큰 고유 ID
- token: 토큰 문자열
- created_at: 생성 시간
- is_used: 사용 여부

### vote_items 테이블
- vote_id: 투표 항목 ID
- title: 투표 제목
- created_at: 생성 시간
- options: 투표 옵션
- is_active: 활성화 상태

### votes 테이블
- id: 투표 기록 ID
- vote_id: 투표 항목 ID
- token_id: 사용된 토큰 ID
- choice: 선택한 옵션
- timestamp: 투표 시간
- voter_name: 투표자 이름

## 개발 환경 설정

1. 가상환경 생성 및 활성화
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
```

2. 필요한 패키지 설치
```bash
pip install -r requirements.txt
```

3. 환경변수 설정
```bash
# .env 파일 생성
echo ADMIN_PASSWORD=your_secure_password > .env
```

4. 개발 서버 실행
```bash
python app.py
```

## 운영 가이드

### 회의장 설정
1. 노트북을 회의장 Wi-Fi에 연결
2. 서버를 실행하고 로컬 IP 확인
3. QR 코드 생성 및 배포
4. 참가자들이 회의장 Wi-Fi에 연결하여 투표

### 네트워크 보안
- 서버는 자동으로 현재 네트워크를 감지하여 보안 설정
- QR 코드는 로컬 IP를 포함하여 외부 접근 방지
- IP 기반 필터링으로 회의장 외부 접근 차단

### 성능
- 노트북 한 대로 100명까지 안정적 운영 가능
- 실시간 투표 현황 모니터링
- 네트워크 트래픽 최소화

## 라이선스

MIT License 